<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy"
        content="default-src 'none'; style-src {{cspSource}} 'unsafe-inline'; script-src 'nonce-{{nonce}}'; img-src {{cspSource}} data:;">
    <link href="{{styleUri}}" rel="stylesheet">
    <title>压缩包预览</title>
</head>

<body>
    <div class="container">
        <!-- 工具栏 -->
        <div class="toolbar">
            <div class="toolbar-left">
                <span class="file-name" id="fileName">{{fileName}}</span>
                <button class="btn btn-icon" id="refreshBtn" title="刷新">
                    <svg viewBox="0 0 24 24">
                        <path
                            d="M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z" />
                    </svg>
                </button>
            </div>
            <div class="toolbar-center">
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="搜索文件名...">
                    <button class="btn btn-primary" id="searchBtn">搜索</button>
                </div>
            </div>
            <div class="toolbar-right">
                <button class="btn btn-primary" id="extractAllBtn">全部解压</button>
            </div>
        </div>

        <!-- 主内容区 -->
        <div class="main-content">
            <!-- 左侧：文件树 -->
            <div class="sidebar">
                <div class="sidebar-header">
                    <h3>文件列表</h3>
                    <span id="fileCount"></span>
                </div>
                <div class="file-tree" id="fileTree">
                    <!-- 动态填充 -->
                </div>
            </div>

            <!-- 中间：预览区域 -->
            <div class="preview-area">
                <div class="preview-header" id="previewHeader">
                    <span>选择文件预览</span>
                </div>
                <div class="preview-content" id="previewContent">
                    <div class="empty-state">
                        <svg viewBox="0 0 24 24" class="empty-icon">
                            <path
                                d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm4 18H6V4h7v5h5v11z" />
                        </svg>
                        <p>点击左侧文件进行预览</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 解压目标选择对话框 -->
        <div class="modal" id="extractModal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>选择解压目标</h3>
                    <button class="btn btn-icon modal-close" id="closeModalBtn">×</button>
                </div>
                <div class="modal-body">
                    <div class="extract-options">
                        <div class="option-group">
                            <label class="radio-label">
                                <input type="radio" name="extractTarget" value="current" checked>
                                <span>当前目录</span>
                            </label>
                            <div class="option-path" id="currentDirPath">{{currentDir}}</div>
                        </div>
                        <div class="option-group">
                            <label class="radio-label">
                                <input type="radio" name="extractTarget" value="subfolder">
                                <span>新建子目录</span>
                            </label>
                            <input type="text" id="subfolderName" class="subfolder-input" placeholder="输入文件夹名称..."
                                value="{{defaultSubfolder}}">
                        </div>
                        <div class="option-group">
                            <label class="radio-label">
                                <input type="radio" name="extractTarget" value="custom">
                                <span>选择其他目录</span>
                            </label>
                            <button class="btn btn-sm" id="browseBtn">浏览...</button>
                            <div class="option-path" id="customDirPath" style="display: none;"></div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" id="cancelExtractBtn">取消</button>
                    <button class="btn btn-primary" id="confirmExtractBtn">解压</button>
                </div>
            </div>
        </div>

        <!-- 状态栏 -->
        <div class="status-bar">
            <span id="statusText">就绪</span>
            <span id="archiveStats"></span>
        </div>
    </div>

    <!-- 加载遮罩 -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
        <span>加载中...</span>
    </div>

    <script nonce="{{nonce}}" src="{{iconsUri}}"></script>
    <script nonce="{{nonce}}" src="{{scriptUri}}"></script>
    <script nonce="{{nonce}}">
        // 初始化配置
        window.archiveConfig = {
            currentDir: '{{currentDir}}',
            fileName: '{{fileName}}',
            filePath: '{{filePath}}'
        };
    </script>
</body>

</html>